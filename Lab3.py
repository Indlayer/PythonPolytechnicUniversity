import math
import random

# ================================================================
# ЛАБОРАТОРНАЯ РАБОТА №3 — "ОРГАНИЗАЦИЯ ЦИКЛОВ"
# Автор: Тимофей Константинович
# ================================================================

# ===================== ЗАДАНИЕ 1 ================================
# Вычислить и вывести таблицу значений функции,
# заданной графически (по ЛР №2) на интервале [-9; 9]
# ================================================================

print("\n================= ЗАДАНИЕ 1 =================")
R = 3
x_start = -9
x_end = 9
dx = 0.5

print("Таблица значений функции:")
print("-----------------------------------------")
print("|   X    |          Y                   |")
print("-----------------------------------------")

x = x_start
while x <= x_end + 1e-9:
    if -9 <= x < -6:
        y = -math.sqrt(R ** 2 - (x + 6) ** 2)
    elif -6 <= x < 0:
        y = math.sqrt(R ** 2 - (x + 3) ** 2)
    elif 0 <= x < 3:
        y = -x + 3
    elif 3 <= x <= 9:
        y = 0.5 * x - 1.5
    else:
        y = None

    print(f"| {x:6.2f} | {y:24.6f} |")
    x += dx

print("-----------------------------------------")
print("Интервал: от -9 до 9, шаг =", dx)


# ===================== ЗАДАНИЕ 2 ================================
# Проверить попадание случайных точек в закрашенные сектора мишени
# ================================================================

print("\n================= ЗАДАНИЕ 2 =================")
R = float(input("Введите радиус мишени R: "))
shots = 10

print("\nРезультаты выстрелов:")
print("-----------------------------------------------------")
print("| № |     X     |     Y     |   Результат           |")
print("-----------------------------------------------------")

for i in range(1, shots + 1):
    x = random.uniform(-R, R)
    y = random.uniform(-R, R)

    inside_circle = x ** 2 + y ** 2 <= R ** 2 + 1e-9
    in_sector1 = (x >= 0 and y >= 0 and y <= x)
    in_sector2 = (x <= 0 and y <= 0 and y >= x)

    if inside_circle and (in_sector1 or in_sector2):
        result = "Попал"
    else:
        result = "Мимо"

    print(f"| {i:2d} | {x:8.3f} | {y:8.3f} | {result:^21} |")

print("-----------------------------------------------------")


# ===================== ЗАДАНИЕ 3 ================================
# Вычислить функцию ln((x+1)/(x-1)) через ряд Тейлора
# На интервале [Xнач, Xкон] с шагом dx и точностью eps
# ================================================================

print("\n================= ЗАДАНИЕ 3 =================")
x_start = 1.1
x_end = 3.0
dx = 0.2
eps = 1e-6

print("Таблица значений функции ln((x+1)/(x-1)) через ряд Тейлора:")
print("--------------------------------------------------------------")
print("|    X    |     f(x) через ряд     |   Точное значение   |  N  |")
print("--------------------------------------------------------------")

x = x_start
while x <= x_end + 1e-9:
    n = 0
    term = 2 / ((2 * n + 1) * (x ** (2 * n + 1)))
    series_sum = 0

    while abs(term) > eps:
        series_sum += term
        n += 1
        term = 2 / ((2 * n + 1) * (x ** (2 * n + 1)))

    fx = series_sum
    exact = math.log((x + 1) / (x - 1))

    print(f"| {x:7.2f} | {fx:23.8f} | {exact:20.8f} | {n:3d} |")
    x += dx

print("--------------------------------------------------------------")
print("Интервал:", x_start, "до", x_end, "шаг =", dx, "точность =", eps)
print("\n================= КОНЕЦ ПРОГРАММЫ =================\n")
